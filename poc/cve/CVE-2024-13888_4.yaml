id: CVE-2024-13888

info:
  name: WPMobile.App <= 11.56 - Open Redirect
  author: s4e-io
  severity: high
  description: |
    The WPMobile.App plugin for WordPress is vulnerable to Open Redirect in all versions up to, and including, 11.56. This is due to insufficient validation on the redirect URL supplied via the 'redirect' parameter. This makes it possible for unauthenticated attackers to redirect users to potentially malicious sites if they can successfully trick them into performing an action.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wpappninja/wpmobileapp-1156-open-redirect-via-redirect-parameter
    - https://nvd.nist.gov/vuln/detail/CVE-2024-13888
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
    cve-id: CVE-2024-13888
    cwe-id: CWE-601
    epss-score: 0.00787
    epss-percentile: 0.72993
  metadata:
    verified: true
    max-request: 2
    vendor: amauri
    product: wpappninja
    framework: wordpress
    fofa-query: body="/wp-content/plugins/wpappninja"
    publicwww-query: "/wp-content/plugins/wpappninja"
  tags: cve,cve2024,redirect,wp,wordpress,wp-plugin,wpappninja

flow: http(1) && http(2)

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'contains(body, "wpappninja")'
        internal: true

  - raw:
      - |
        GET /?redirect=aHR0cDovL29hc3QubWU=&WPMOBILE_LOCALE=en HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)oast\.me\/?(\/|[^.].*)?$'
# digest: 4a0a00473045022100ff5b038e34e3c09db9e4f6491f77b0cd3cb30dc96695c6e61da22cd47d448f56022048b74191e1f3ae3e89b99b3976e9646a4c11cf1d13b3a2d69d874550aeb0f721:922c64590222798bb761d5b6d8e72950